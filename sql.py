def optimize(lineup, minutes):
    string = 'select PlayersBios_TEAM_ABBREVIATION, "' + str(lineup) + '" "Lineup", ' + str(minutes) + ' "Min", round(sum(("PlayersGeneralStats_PTS"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS, round(sum(("PlayersGeneralStats_FGM"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FGM, round(sum(("PlayersGeneralStats_FGA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FGA, round(sum(("PlayersGeneralStats_FGM"*' + str(minutes) + ')/PlayersGeneralStats_MIN)/sum(("PlayersGeneralStats_FGA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG_PCT, round(sum(("PlayersGeneralStats_FG3M"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG3M, round(sum(("PlayersGeneralStats_FG3A"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG3A, round(sum(("PlayersGeneralStats_FG3M"*' + str(minutes) + ')/PlayersGeneralStats_MIN)/sum(("PlayersGeneralStats_FG3A"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG3_PCT, round(sum(("PlayersGeneralStats_FTM"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FTM, round(sum(("PlayersGeneralStats_FTA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FTA, round(sum(("PlayersGeneralStats_FTM"*' + str(minutes) + ')/PlayersGeneralStats_MIN)/sum(("PlayersGeneralStats_FTA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FT_PCT, round(sum(("PlayersGeneralStats_OREB"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OREB, round(sum(("PlayersGeneralStats_DREB"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) DREB, round(sum(("PlayersGeneralStats_REB"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) REB, round(sum(("PlayersGeneralStats_AST"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) AST, round(sum(("PlayersGeneralStats_TOV"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) TOV, round(sum(("PlayersGeneralStats_STL"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) STL, round(sum(("PlayersGeneralStats_BLK"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) BLK, round(sum(("PlayersGeneralStats_BLKA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) BLKA, round(sum(("PlayersGeneralStats_PF"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PF, round(sum(("PlayersGeneralStats_PFD"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PFD, round(sum((PlayersGeneralStats_AST*' + str(minutes) + ')/PlayersGeneralStats_MIN)	/sum(("PlayersGeneralStats_FGA"*' + str(minutes) + ')/PlayersGeneralStats_MIN)	+(0.44*(sum(("PlayersGeneralStats_FTA"*' + str(minutes) + ')/PlayersGeneralStats_MIN))	+(sum((PlayersGeneralStats_AST*' + str(minutes) + ')/PlayersGeneralStats_MIN))	+(sum(("PlayersGeneralStats_TOV"*' + str(minutes) + ')/PlayersGeneralStats_MIN))), 2) AST_RATIO, round(avg(PlayersGeneralScoringStats_PCT_AST_FGM), 2) AST_PCT, round(sum(PlayersGeneralStats_AST)/SUM(PlayersGeneralStats_TOV), 2) "AST/TO", round(sum(PlayersGeneralAdvancedStats_OREB_PCT), 2) OREB_PCT, round(sum(PlayersGeneralAdvancedStats_DREB_PCT), 2) DREB_PCT, round(sum(PlayersGeneralAdvancedStats_REB_PCT), 2) REB_PCT, round(avg(PlayersGeneralAdvancedStats_E_TOV_PCT), 2) TOV_PCT, round(avg((PlayersGeneralStats_FGM + (0.5 * PlayersGeneralStats_FG3M))/PlayersGeneralStats_FGA), 2) eFG, round(avg((PlayersGeneralStats_PTS / ((2*PlayersGeneralStats_FGA) + (0.88*PlayersGeneralStats_FTA)))), 2) "TS%", round(avg(PlayersGeneralAdvancedStats_PACE), 2) PACE, round(sum(PlayersGeneralAdvancedStats_PIE*100), 2) PIE, round(sum((PlayersGeneralMiscStats_PTS_OFF_TOV*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_OFF_TOV, round(sum((PlayersGeneralMiscStats_PTS_2ND_CHANCE*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_2ND_CHANCE, round(sum((PlayersGeneralMiscStats_PTS_FB*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_FB, round(sum((PlayersGeneralMiscStats_PTS_PAINT*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_PAINT, round(avg((PlayersGeneralMiscStats_OPP_PTS_OFF_TOV*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_OFF_TOV, round(avg((PlayersGeneralMiscStats_OPP_PTS_2ND_CHANCE*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_2ND_CHANCE, round(avg((PlayersGeneralMiscStats_OPP_PTS_FB*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_FB, round(avg((PlayersGeneralMiscStats_OPP_PTS_PAINT*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_PAINT, round(avg("PlayersGeneralScoringStats_PCT_FGA_2PT"), 2) PCT_FGA_2PT, round(avg("PlayersGeneralScoringStats_PCT_FGA_3PT"), 2) PCT_FGA_3PT, round(avg("PlayersGeneralScoringStats_PCT_PTS_2PT"), 2) PCT_PTS_2PT, round(avg("PlayersGeneralScoringStats_PCT_PTS_2PT_MR"), 2) PCT_PTS_2PT_MR, round(avg("PlayersGeneralScoringStats_PCT_PTS_3PT"), 2) PCT_PTS_3PT, round(avg("PlayersGeneralScoringStats_PCT_PTS_FB"), 2) PCT_PTS_FB, round(avg("PlayersGeneralScoringStats_PCT_PTS_FT"), 2) PCT_PTS_FT, round(avg("PlayersGeneralScoringStats_PCT_PTS_OFF_TOV"), 2) PCT_PTS_OFF_TOV, round(avg("PlayersGeneralScoringStats_PCT_PTS_PAINT"), 2) PCT_PTS_PAINT, round(avg("PlayersGeneralScoringStats_PCT_AST_2PM"), 2) PCT_AST_2PM, round(avg("PlayersGeneralScoringStats_PCT_UAST_2PM"), 2) PCT_UAST_2PM, round(avg("PlayersGeneralScoringStats_PCT_AST_3PM"), 2) PCT_AST_3PM, round(avg("PlayersGeneralScoringStats_PCT_UAST_3PM"), 2) PCT_UAST_3PM, round(avg("PlayersGeneralScoringStats_PCT_AST_FGM"), 2) PCT_AST_FGM, round(avg("PlayersGeneralScoringStats_PCT_UAST_FGM"), 2) PCT_UAST_FGM, round(avg("PlayersGeneralStatsDetailed_OPP_FGM"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FGM, round(avg("PlayersGeneralStatsDetailed_OPP_FGA"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FGA, round(avg("PlayersGeneralStatsDetailed_OPP_FG_PCT"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG_PCT, round(avg("PlayersGeneralStatsDetailed_OPP_FG3M"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG3M, round(avg("PlayersGeneralStatsDetailed_OPP_FG3A"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG3A, round(avg("PlayersGeneralStatsDetailed_OPP_FG3_PCT"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG3_PCT, round(avg("PlayersGeneralStatsDetailed_OPP_FTM"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FTM, round(avg("PlayersGeneralStatsDetailed_OPP_FTA"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FTA, round(avg("PlayersGeneralStatsDetailed_OPP_FT_PCT"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FT_PCT, round(avg("PlayersGeneralStatsDetailed_OPP_OREB"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_OREB, round(avg("PlayersGeneralStatsDetailed_OPP_DREB"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_DREB, round(avg("PlayersGeneralStatsDetailed_OPP_REB"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_REB, round(avg("PlayersGeneralStatsDetailed_OPP_AST"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_AST, round(avg("PlayersGeneralStatsDetailed_OPP_TOV"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_TOV, round(avg("PlayersGeneralStatsDetailed_OPP_STL"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_STL, round(avg("PlayersGeneralStatsDetailed_OPP_BLK"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_BLK, round(avg("PlayersGeneralStatsDetailed_OPP_BLKA"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_BLKA, round(avg("PlayersGeneralStatsDetailed_OPP_PF"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_PF, round(avg("PlayersGeneralStatsDetailed_OPP_PFD"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_PFD, round(avg("PlayersGeneralStatsDetailed_OPP_PTS"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_PTS FROM Dataset_Players WHERE PlayersBios_PLAYER_ID in (' + lineup + ') and PlayersBios_Season = "2020-21" '
    return string

def optimize_players_stats(lineup, minutes):
    string = 'select PlayersBios_TEAM_ABBREVIATION, PlayersBios_PLAYER_NAME "PlayerName", ' + str(minutes) + ' "Min", round(sum(("PlayersGeneralStats_PTS"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS, round(sum(("PlayersGeneralStats_FGM"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FGM, round(sum(("PlayersGeneralStats_FGA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FGA, round(sum(("PlayersGeneralStats_FGM"*' + str(minutes) + ')/PlayersGeneralStats_MIN)/sum(("PlayersGeneralStats_FGA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG_PCT, round(sum(("PlayersGeneralStats_FG3M"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG3M, round(sum(("PlayersGeneralStats_FG3A"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG3A, round(sum(("PlayersGeneralStats_FG3M"*' + str(minutes) + ')/PlayersGeneralStats_MIN)/sum(("PlayersGeneralStats_FG3A"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FG3_PCT, round(sum(("PlayersGeneralStats_FTM"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FTM, round(sum(("PlayersGeneralStats_FTA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FTA, round(sum(("PlayersGeneralStats_FTM"*' + str(minutes) + ')/PlayersGeneralStats_MIN)/sum(("PlayersGeneralStats_FTA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) FT_PCT, round(sum(("PlayersGeneralStats_OREB"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OREB, round(sum(("PlayersGeneralStats_DREB"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) DREB, round(sum(("PlayersGeneralStats_REB"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) REB, round(sum(("PlayersGeneralStats_AST"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) AST, round(sum(("PlayersGeneralStats_TOV"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) TOV, round(sum(("PlayersGeneralStats_STL"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) STL, round(sum(("PlayersGeneralStats_BLK"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) BLK, round(sum(("PlayersGeneralStats_BLKA"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) BLKA, round(sum(("PlayersGeneralStats_PF"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PF, round(sum(("PlayersGeneralStats_PFD"*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PFD, round(sum((PlayersGeneralStats_AST*' + str(minutes) + ')/PlayersGeneralStats_MIN)	/sum(("PlayersGeneralStats_FGA"*' + str(minutes) + ')/PlayersGeneralStats_MIN)	+(0.44*(sum(("PlayersGeneralStats_FTA"*' + str(minutes) + ')/PlayersGeneralStats_MIN))	+(sum((PlayersGeneralStats_AST*' + str(minutes) + ')/PlayersGeneralStats_MIN))	+(sum(("PlayersGeneralStats_TOV"*' + str(minutes) + ')/PlayersGeneralStats_MIN))), 2) AST_RATIO, round(avg(PlayersGeneralScoringStats_PCT_AST_FGM), 2) AST_PCT, round(sum(PlayersGeneralStats_AST)/SUM(PlayersGeneralStats_TOV), 2) "AST/TO", round(sum(PlayersGeneralAdvancedStats_OREB_PCT), 2) OREB_PCT, round(sum(PlayersGeneralAdvancedStats_DREB_PCT), 2) DREB_PCT, round(sum(PlayersGeneralAdvancedStats_REB_PCT), 2) REB_PCT, round(avg(PlayersGeneralAdvancedStats_E_TOV_PCT), 2) TOV_PCT, round(avg((PlayersGeneralStats_FGM + (0.5 * PlayersGeneralStats_FG3M))/PlayersGeneralStats_FGA), 2) eFG, round(avg((PlayersGeneralStats_PTS / ((2*PlayersGeneralStats_FGA) + (0.88*PlayersGeneralStats_FTA)))), 2) "TS%", round(avg(PlayersGeneralAdvancedStats_PACE), 2) PACE, round(sum(PlayersGeneralAdvancedStats_PIE*100), 2) PIE, round(sum((PlayersGeneralMiscStats_PTS_OFF_TOV*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_OFF_TOV, round(sum((PlayersGeneralMiscStats_PTS_2ND_CHANCE*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_2ND_CHANCE, round(sum((PlayersGeneralMiscStats_PTS_FB*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_FB, round(sum((PlayersGeneralMiscStats_PTS_PAINT*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) PTS_PAINT, round(avg((PlayersGeneralMiscStats_OPP_PTS_OFF_TOV*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_OFF_TOV, round(avg((PlayersGeneralMiscStats_OPP_PTS_2ND_CHANCE*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_2ND_CHANCE, round(avg((PlayersGeneralMiscStats_OPP_PTS_FB*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_FB, round(avg((PlayersGeneralMiscStats_OPP_PTS_PAINT*' + str(minutes) + ')/PlayersGeneralStats_MIN), 2) OPP_PTS_PAINT, round(avg("PlayersGeneralScoringStats_PCT_FGA_2PT"), 2) PCT_FGA_2PT, round(avg("PlayersGeneralScoringStats_PCT_FGA_3PT"), 2) PCT_FGA_3PT, round(avg("PlayersGeneralScoringStats_PCT_PTS_2PT"), 2) PCT_PTS_2PT, round(avg("PlayersGeneralScoringStats_PCT_PTS_2PT_MR"), 2) PCT_PTS_2PT_MR, round(avg("PlayersGeneralScoringStats_PCT_PTS_3PT"), 2) PCT_PTS_3PT, round(avg("PlayersGeneralScoringStats_PCT_PTS_FB"), 2) PCT_PTS_FB, round(avg("PlayersGeneralScoringStats_PCT_PTS_FT"), 2) PCT_PTS_FT, round(avg("PlayersGeneralScoringStats_PCT_PTS_OFF_TOV"), 2) PCT_PTS_OFF_TOV, round(avg("PlayersGeneralScoringStats_PCT_PTS_PAINT"), 2) PCT_PTS_PAINT, round(avg("PlayersGeneralScoringStats_PCT_AST_2PM"), 2) PCT_AST_2PM, round(avg("PlayersGeneralScoringStats_PCT_UAST_2PM"), 2) PCT_UAST_2PM, round(avg("PlayersGeneralScoringStats_PCT_AST_3PM"), 2) PCT_AST_3PM, round(avg("PlayersGeneralScoringStats_PCT_UAST_3PM"), 2) PCT_UAST_3PM, round(avg("PlayersGeneralScoringStats_PCT_AST_FGM"), 2) PCT_AST_FGM, round(avg("PlayersGeneralScoringStats_PCT_UAST_FGM"), 2) PCT_UAST_FGM, round(avg("PlayersGeneralStatsDetailed_OPP_FGM"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FGM, round(avg("PlayersGeneralStatsDetailed_OPP_FGA"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FGA, round(avg("PlayersGeneralStatsDetailed_OPP_FG_PCT"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG_PCT, round(avg("PlayersGeneralStatsDetailed_OPP_FG3M"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG3M, round(avg("PlayersGeneralStatsDetailed_OPP_FG3A"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG3A, round(avg("PlayersGeneralStatsDetailed_OPP_FG3_PCT"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FG3_PCT, round(avg("PlayersGeneralStatsDetailed_OPP_FTM"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FTM, round(avg("PlayersGeneralStatsDetailed_OPP_FTA"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FTA, round(avg("PlayersGeneralStatsDetailed_OPP_FT_PCT"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_FT_PCT, round(avg("PlayersGeneralStatsDetailed_OPP_OREB"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_OREB, round(avg("PlayersGeneralStatsDetailed_OPP_DREB"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_DREB, round(avg("PlayersGeneralStatsDetailed_OPP_REB"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_REB, round(avg("PlayersGeneralStatsDetailed_OPP_AST"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_AST, round(avg("PlayersGeneralStatsDetailed_OPP_TOV"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_TOV, round(avg("PlayersGeneralStatsDetailed_OPP_STL"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_STL, round(avg("PlayersGeneralStatsDetailed_OPP_BLK"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_BLK, round(avg("PlayersGeneralStatsDetailed_OPP_BLKA"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_BLKA, round(avg("PlayersGeneralStatsDetailed_OPP_PF"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_PF, round(avg("PlayersGeneralStatsDetailed_OPP_PFD"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_PFD, round(avg("PlayersGeneralStatsDetailed_OPP_PTS"*' + str(minutes) + '/PlayersGeneralStats_MIN), 2) OPP_PTS FROM Dataset_Players WHERE PlayersBios_PLAYER_ID in (' + lineup + ') and PlayersBios_Season = "2020-21" '
    return string